@using Fluxor
@using DeusVultClicker.Client.Shared.Store.Actions
@using DeusVultClicker.Client.Hooks
@inherits Fluxor.Blazor.Web.Components.FluxorComponent
<Fluxor.Blazor.Web.StoreInitializer />

<header><h1>Deus Vult Clicker</h1></header>
<main>
    <Grid />
</main>
<footer>Footer</footer>
<style>
    header {
        display: flex;
    }

        header h1 {
            flex: 1;
        }

    main {
        flex: 1;
    }
</style>

@code
{
    [Inject]
    private IDispatcher Dispatcher { get; set; }

    protected override async Task OnAfterRenderAsync(bool firstRender)
    {
        await base.OnAfterRenderAsync(firstRender);
        this.Dispatcher.Dispatch(new LoadSaveStateAction());
        Window.OnBlur += (_, _) => this.Dispatcher.Dispatch(new SaveSaveStateAction());
        Window.OnFocus += (_, _) => this.Dispatcher.Dispatch(new LoadSaveStateAction());
    }
}
